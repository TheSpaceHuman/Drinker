!function(t,s){"use strict";t.Cookies||console.error("WooCommerce Cookies Jar is not available.");var i=function(){function t(){null===window.localStorage.getItem(this.STORAGE_KEY)&&window.localStorage.setItem(this.STORAGE_KEY,"[]")}return Object.defineProperty(t.prototype,"STORAGE_KEY",{value:"zooWishlistItems",writable:!1,enumerable:!1,configurable:!1}),t.prototype.add=function(t){var i=this.list();if(t=parseInt(t,10),-1!==i.indexOf(t))return!1;i.push(t);var e=JSON.stringify(i);return window.localStorage.setItem(this.STORAGE_KEY,e),Cookies.remove(this.STORAGE_KEY),Cookies.set(this.STORAGE_KEY,e),!0},t.prototype.exists=function(t){return-1!==this.list().indexOf(t)},t.prototype.remove=function(t){var i=this.list(),e=i.indexOf(t);if(-1===e)return!1;i.splice(e,1);var o=JSON.stringify(i);return window.localStorage.setItem(this.STORAGE_KEY,o),Cookies.remove(this.STORAGE_KEY),Cookies.set(this.STORAGE_KEY,o),!0},t.prototype.list=function(){return JSON.parse(window.localStorage.getItem(this.STORAGE_KEY))},t.prototype.clear=function(){window.localStorage.setItem(this.STORAGE_KEY,"[]"),Cookies.remove(this.STORAGE_KEY)},t}(),e=function(){function t(){this.panel=s(".zoo-wishlist-panel"),this.counter=s(".element-header-wishlist .wishlist-counter"),this.addBtn=".add-to-wishlist",this.removeBtn=".remove-from-wishlist",this.browseBtn=".browse-wishlist:not(.redirect-link)",this.panel.length||(this.renderPanel(),this.panel=s(".zoo-wishlist-panel"))}return t.prototype.renderPanel=function(t){t=t||"<p>"+zooWishlistCDATA.wishlistIsEmpty+"</p>",this.panel.length?this.panel.find(".zoo-wishlist-panel-inner").html(t):s("body").append('<div class="zoo-wishlist-panel zoo-popup-panel" style="display:none"><div class="loading popup-mask-close"></div><button class="zoo-wishlist-panel-close-btn popup-close-btn" type="button" name="close-button"><i class="zoo-icon-close"></i> </button><div class="zoo-wishlist-panel-inner zoo-popup-inner" style="display: none">'+t+"</div></div></div>")},t.prototype.renderAddButton=function(t){if(!t instanceof jQuery)throw new TypeError("Factoring wishlist button is not an instance of jQuery.");t.hasClass("browse-wishlist")&&t.removeClass("browse-wishlist"),t.hasClass("add-to-wishlist")||t.addClass("add-to-wishlist"),t.attr("title",zooWishlistCDATA.addToWishlist),t.html(zooWishlistCDATA.addToWishlistIcon+zooWishlistCDATA.addToWishlist)},t.prototype.renderBrowseButton=function(t){if(!t instanceof jQuery)throw new TypeError("Factoring wishlist button is not an instance of jQuery.");(t=s(document).find(".zoo-wishlist-button[data-id="+t.data("id")+"]")).removeClass("add-to-wishlist"),t.not(".browse-wishlist").addClass("browse-wishlist"),t.attr("title",zooWishlistCDATA.browseWishlist),t.html(zooWishlistCDATA.browseWishlistIcon+zooWishlistCDATA.browseWishlist)},t}(),o=function(){function t(t,i){this.view=i,this.model=t,this.doingAJAX=!1;var e=this.model.list().length;this.view.counter.text(e),e<1?this.view.counter.addClass("zoo-hidden"):this.view.counter.removeClass("zoo-hidden"),this.updateAddButtonsActions(),this.listen()}return t.prototype.sync=function(t){if("zooWishlistItems"===t.key){var i=JSON.parse(window.localStorage.getItem("zooWishlistItems"));s(".wishlist-counter").text(i.length),i.length<1&&s(".wishlist-counter").addClass("zoo-hidden")}},t.prototype.updateAddButtonsActions=function(){var e=this,o=this.model.list();s(this.view.addBtn).each(function(t){if(!(!this instanceof HTMLElement)){var i=parseInt(this.dataset.id);-1!==o.indexOf(i)&&e.view.renderBrowseButton(s(this))}})},t.prototype.addAction=function(t){var i=s(t.currentTarget),e=i.data("id");if(!i.hasClass("browse-wishlist")||!i.hasClass("redirect-link")){if(t.preventDefault(),i.hasClass("browse-wishlist"))return this.browseAction(t);if(this.model.exists(e))this.view.renderBrowseButton(i);else if(this.model.add(e)){if(this.view.renderBrowseButton(i),this.view.counter.removeClass("zoo-hidden"),this.view.counter.text(this.model.list().length),!i.hasClass("redirect-link"))return this.browseAction(t);s(document).find(".zoo-product-popup-notice")[0]?s(document).find(".zoo-product-popup-notice").addClass("active"):(s("body").append('<div class="zoo-product-popup-notice">'+i.data("label-added")+"</div>"),setTimeout(function(){s(document).find(".zoo-product-popup-notice").addClass("active")},100)),setTimeout(function(){s(document).find(".zoo-product-popup-notice").removeClass("active")},1200)}else alert(zooWishlistCDATA.addToWishlistErr)}},t.prototype.removeAction=function(t){t.preventDefault();var i=s(t.currentTarget).data("id");if(this.model.remove(i)){var e=this.model.list().length;e?this.view.panel.find("#wislist-item-row-"+i).remove():this.view.renderPanel("<p>"+zooWishlistCDATA.wishlistIsEmpty+"</p>"),this.view.counter.text(e),e<1&&this.view.counter.addClass("zoo-hidden")}},t.prototype.browseAction=function(t){t.preventDefault();var i=this,e=this.model.list();i.view.panel.fadeIn(),e.length&&!this.doingAJAX?(this.doingAJAX=!0,s.ajax({method:"POST",url:ajaxurl,data:{action:"zoo_get_wishlist_products",wishlistItems:JSON.stringify(e)}}).done(function(t){i.doingAJAX=!1,i.view.renderPanel(t.html),i.view.removeBtn=".remove-from-wishlist",s(document).on("click",i.view.removeBtn,function(t){i.removeAction(t)}),i.view.panel.find(".zoo-wishlist-panel-inner").fadeIn()})):i.view.panel.find(".zoo-wishlist-panel-inner").fadeIn(),s(document).trigger("zoo_browse_wishlist")},t.prototype.listen=function(){var i=this;s(document).on("click",this.view.addBtn,function(t){i.addAction(t)}),s(this.view.removeBtn).length&&s(document).on("click",this.view.removeBtn,function(t){i.removeAction(t)}),s(document).on("click",this.view.browseBtn,function(t){i.browseAction(t)}),this.view.panel.find(".zoo-wishlist-panel-close-btn").on("click",function(t){i.view.panel.fadeOut()}),this.view.panel.find(".popup-mask-close").on("click",function(t){i.view.panel.fadeOut()}),window.addEventListener("storage",this.sync)},t}();s(document).ready(function(){t.zooWishlist=new o(new i,new e)})}(window,jQuery);